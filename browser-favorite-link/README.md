# 飞书书签保存器 Chrome扩展

一个强大的Chrome浏览器扩展，可以快速将网页URL保存到飞书多维表格中。支持URL唯一性检查、智能信息提取和批量管理。

## ✨ 主要功能

### 🚀 核心功能
- **一键保存**: 快速将当前网页保存到飞书多维表格
- **智能提取**: 自动提取页面标题、描述和关键词
- **URL去重**: 自动检测重复URL，支持覆盖更新
- **标签管理**: 支持自定义标签分类
- **批量操作**: 支持批量导入导出设置

### 🔧 高级特性
- **Manifest V3**: 使用最新的Chrome扩展标准
- **智能识别**: 自动识别页面内容并填充表单
- **配置灵活**: 支持多个飞书应用和表格配置
- **安全可靠**: 数据直接存储在您的飞书表格中
- **实时同步**: 与飞书表格实时同步

### 🎨 用户体验
- **响应式设计**: 完美适配各种屏幕尺寸
- **暗色模式**: 支持系统暗色模式
- **快捷键支持**: Ctrl+S快速保存，Ctrl+E智能提取
- **实时反馈**: 清晰的成功/错误状态提示
- **连接测试**: 内置连接测试功能

## 📦 安装方法

### 方法一：开发者模式安装

1. 克隆或下载本项目到本地
2. 打开Chrome浏览器，输入 `chrome://extensions/`
3. 开启右上角的"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择项目文件夹
6. 扩展安装完成！

### 方法二：打包安装

1. 在扩展管理页面点击"打包扩展程序"
2. 选择项目文件夹，生成.crx文件
3. 双击.crx文件进行安装

## 🔧 配置说明

### 1. 创建飞书应用

1. 访问 [飞书开放平台](https://open.feishu.cn)
2. 点击"创建应用" → "自建应用"
3. 填写应用名称和描述
4. 在"权限管理"中添加权限：
   - `查看、评论、编辑和管理多维表格`

### 2. 获取应用凭据

在应用详情页面获取：
- **App ID**: 应用的唯一标识符
- **App Secret**: 应用的密钥（请妥善保管）

### 3. 创建多维表格

1. 在飞书中创建新的多维表格
2. 添加以下字段：
   - `网站地址` - 超链接类型
   - `网站的中文说明` - 文本类型
   - `网站的备注` - 多行文本类型
   - `网站的标签` - 单选类型
   - `创建时间` - 日期时间类型

3. 设置单选字段的选项：
   - 工作、学习、娱乐、工具、新闻、购物、社交、其他

### 4. 配置表格权限

1. 点击表格右上角的"分享"按钮
2. 添加您的应用为协作者
3. 设置权限为"可编辑"
4. 复制表格的完整URL

### 5. 配置扩展

1. 右键点击扩展图标，选择"选项"
2. 填入App ID、App Secret和表格URL
3. 点击"测试连接"确保配置正确
4. 点击"保存配置"

## 📖 使用方法

### 基本使用

1. 在浏览器中打开要保存的网页
2. 点击扩展图标打开弹出窗口
3. 填写网站说明（必填）
4. 选择标签（可选）
5. 添加备注（可选）
6. 点击"保存到飞书"

### 高级功能

#### 智能提取
- 点击"自动提取"按钮，自动填充页面描述
- 支持从meta标签、h1标题等提取信息
- 智能推荐标签

#### URL去重
- 保存时自动检查URL是否已存在
- 如果存在，显示确认对话框
- 可选择覆盖更新或取消操作

#### 快捷键
- `Ctrl+S` - 保存到飞书
- `Ctrl+E` - 智能提取信息
- `Ctrl+C` - 复制URL

## 🛠️ 开发说明

### 项目结构

```
browser-favorite-link/
├── manifest.json          # 扩展配置文件
├── popup.html            # 弹出窗口界面
├── popup.js              # 弹出窗口逻辑
├── popup.css             # 弹出窗口样式
├── options.html          # 选项页面
├── options.js            # 选项页面逻辑
├── options.css           # 选项页面样式
├── background.js          # Service Worker
├── common.js             # 公共函数
├── record-manager.js     # 记录管理器
├── icons/                # 图标文件
└── README.md             # 项目说明
```

### 核心组件

#### Service Worker (background.js)
- 处理所有飞书API调用
- 管理扩展生命周期
- 处理消息通信

#### Popup 界面 (popup.html/js/css)
- 用户交互界面
- 表单验证和提交
- 状态管理和反馈

#### Options 页面 (options.html/js/css)
- 配置管理界面
- 连接测试功能
- 设置导入导出

#### 记录管理器 (record-manager.js)
- 飞书API封装
- 数据格式化
- 错误处理

### API集成

使用飞书开放平台的多维表格API：
- 获取访问令牌
- 读取表格信息
- 添加/更新记录
- 字段映射和转换

### 数据流

1. 用户在popup中填写信息
2. popup.js发送消息到background.js
3. background.js调用飞书API
4. API返回结果，更新UI状态

## 🐛 故障排除

### 常见问题

#### 1. 连接测试失败
- 检查App ID和App Secret是否正确
- 确保应用已发布到企业内
- 检查表格URL格式是否正确
- 确保表格已分享给应用

#### 2. 保存失败
- 检查字段名称是否与表格一致
- 确保应用有编辑权限
- 检查网络连接是否正常

#### 3. 权限错误
- 确保应用有"查看、评论、编辑和管理多维表格"权限
- 确保表格已正确分享给应用

#### 4. 字段错误
- 检查表格字段名称是否正确
- 确保字段类型匹配

### 错误代码

| 代码 | 说明 | 解决方案 |
|------|------|----------|
| 91402 | 表格不存在或无权限 | 检查表格URL和权限设置 |
| 91403 | 权限不足 | 检查应用权限和表格分享 |
| 1254043 | 字段名称不匹配 | 检查字段名称 |
| 1254060 | 文本字段转换失败 | 检查文本字段格式 |
| 1254061 | 超链接字段转换失败 | 检查URL字段格式 |
| 1254062 | 单选字段转换失败 | 检查单选字段格式 |
| 1254064 | 日期时间字段转换失败 | 检查日期字段格式 |

## 🔄 更新日志

### v1.0.0 (2024-01-15)
- 初始版本发布
- 支持基本的URL保存功能
- 智能信息提取
- URL唯一性检查和覆盖更新
- 完整的配置管理界面

## 🤝 贡献指南

欢迎贡献代码、报告问题或提出建议！

### 开发环境

1. 克隆项目到本地
2. 在Chrome中加载为未打包扩展
3. 修改代码后重新加载扩展

### 提交规范

- 使用清晰的提交信息
- 遵循项目的代码风格
- 确保功能正常工作

## 📄 许可证

本项目采用 MIT 许可证。

## 🙏 致谢

- 感谢飞书开放平台提供的API支持
- 感谢所有贡献者的努力

---

**如有问题或建议，请提交Issue或Pull Request。**